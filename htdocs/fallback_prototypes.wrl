#VRML V2.0 utf8

# This VRML file specifies "fallback" prototypes for extensions
# of Kambi VRML game engine,
# [http://vrmlengine.sourceforge.net/kambi_vrml_extensions.php].
#
# This file will *not* be used by Kambi VRML game engine programs
# (like view3dscene), as they have appropriate nodes simply built-in.
#
# This file may be used by other VRML browsers so that they are able
# to partially understand these extension nodes, or at least omit them
# gracefullly.

PROTO Text3D [
  exposedField MFString string []
  exposedField SFNode fontStyle NULL
  exposedField MFFloat length []
  exposedField SFFloat maxExtent 0
  exposedField SFFloat depth 0.1
  exposedField SFBool solid TRUE
] {
  Text {
    string IS string
    fontStyle IS fontStyle
    length IS length
    maxExtent IS maxExtent
  }
}

PROTO KambiAppearance [
  exposedField SFNode material          NULL
  exposedField SFNode texture           NULL
  exposedField SFNode textureTransform  NULL

  # This is from X3D.
  # Kambi VRML game engine treats it as part of normal Appearance
  # node, but actually this is an extension for pure VRML 2.0.
  exposedField SFNode fillProperties    NULL
  exposedField SFNode lineProperties    NULL
  exposedField SFNode metadata          NULL
  exposedField MFNode shaders           []

  # Kambi extensions
  exposedField SFNode normalMap         NULL
  exposedField SFNode heightMap         NULL
  exposedField SFFloat heightMapScale   0.01
  exposedField SFNode blendMode         NULL
] {
  Appearance {
    material IS material
    texture IS texture
    textureTransform IS textureTransform
  }
}

PROTO BlendMode [
  exposedField SFString srcFactor "src_alpha"
  exposedField SFString destFactor "one_minus_src_alpha"
  exposedField SFColor color 1 1 1
  exposedField SFFloat colorTransparency 0
] {
  Group { } # expand to nothing, just ignore this node if you can't handle it natively
}

PROTO KambiTriangulation [
  exposedField SFLong    quadricSlices    -1     # {-1} + [3, infinity)
  exposedField SFLong    quadricStacks    -1     # {-1} + [2, infinity)
  exposedField SFLong    rectDivisions    -1     # [-1, infinity)
] {
  Group { } # expand to nothing, just ignore this node if you can't handle it natively
}

PROTO KambiHeadLight [
  exposedField SFFloat     ambientIntensity      0           # [0.0, 1.0]
  exposedField SFVec3f     attenuation           1 0 0       # [0, infinity)
  exposedField SFColor     color                 1 1 1       # [0, 1]
  exposedField SFFloat     intensity             1           # [0, 1]
  exposedField SFBool      spot                  FALSE
  exposedField SFFloat     spotDropOffRate       0
  exposedField SFFloat     spotCutOffAngle       0.785398
] {
  Group { } # expand to nothing, just ignore this node if you can't handle it natively
}

PROTO KambiInline [
  exposedField MFString url        []
  field        SFVec3f  bboxCenter 0 0 0
  field        SFVec3f  bboxSize   -1 -1 -1
  exposedField MFString    replaceNames  []
  exposedField MFNode      replaceNodes  []
] {
  Inline {
    url IS url
    bboxCenter IS bboxCenter
    bboxSize IS bboxSize
  }
}

# See http://instant-reality.com/documentation/nodetype/MatrixTransform/
PROTO MatrixTransform [
  exposedField     MFNode     children     []
  field            SFVec3f    bboxCenter   0 0 0
  field            SFVec3f    bboxSize     -1 -1 -1
  exposedField     SFMatrix4f matrix       1 0 0 0
                                           0 1 0 0
                                           0 0 1 0
                                           0 0 0 1
] {
  Group {
    children IS children
    bboxCenter IS bboxCenter
    bboxSize IS bboxSize
  }
}

# See http://instant-reality.com/documentation/nodetype/Teapot/
PROTO Teapot [
  exposedField SFVec3f size   3 3 3
  exposedField SFBool  solid  TRUE
] {
  # This could be expanded to
  #   Transform {
  #     scale IS size
  #     children IndexedFaceSet {
  #       solid IS solid
  #       .... teapot data in coord, coordIndex etc. ....
  #     }
  #   }
  #
  # For now expand to nothing, just ignore this node if you can't
  # handle it natively.

  Group { }
}
