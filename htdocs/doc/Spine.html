<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_intro">1. Intro</a></li>
<li><a href="#_how_to_use_spine_animations_in_your_own_games">2. How to use Spine animations in your own games</a>
<ul class="sectlevel2">
<li><a href="#_overview_of_spine_and_2d_usage_in_the_engine">2.1. Overview of Spine and 2D usage in the engine</a></li>
</ul>
</li>
<li><a href="#_creating_spine_models">3. Creating Spine models</a></li>
<li><a href="#_spine_features_support">4. Spine features support</a>
<ul class="sectlevel2">
<li><a href="#_skins">4.1. Skins</a></li>
<li><a href="#_atlases">4.2. Atlases</a></li>
<li><a href="#_other_features">4.3. Other features</a></li>
<li><a href="#_missing_contributions_are_welcome">4.4. Missing (contributions are welcome!)</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Castle Game Engine <a href="https://castle-engine.io/" class="bare">https://castle-engine.io/</a> has an advanced support for Spine <a href="http://esotericsoftware.com/" class="bare">http://esotericsoftware.com/</a> 2D animations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_intro">1. Intro</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spine is a great software to design 2D animations for games, using modern techniques (bones, skins, meshes etc.). Animations done this way are lightweight: their loading and rendering is very efficient, even on mobile devices like Android or iOS. But they are also very flexible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they look smooth regardless of the playback speed,</p>
</li>
<li>
<p>you can reuse the same animations by changing skins,</p>
</li>
<li>
<p>you can change attachments during animation,</p>
</li>
<li>
<p>and more (see Spine website for exhaustive list :).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use <a href="https://castle-engine.io/view3dscene.php">view3dscene</a> to open Spine animations.</p>
</div>
<div class="paragraph">
<p>You can also add Spine animations using the <a href="https://castle-engine.io/manual_editor.php">editor</a>, just add a <code>TCastleScene</code> and set the scene <code>URL</code> to point to the JSON file.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Some sample Spine animations are in <a href="https://github.com/castle-engine/demo-models">demo models</a> in subdirectory <a href="https://github.com/castle-engine/demo-models/tree/master/spine">spine</a>. They are also used by some examples, like <a href="https://github.com/castle-engine/castle-engine/tree/master/examples/animations/play_animation">examples/animations/play_animation</a> and by our "New Project" -&gt; "2D game" template.</p>
</li>
<li>
<p>Just open a project exported from Spine (as a JSON file) using <a href="https://castle-engine.io/view3dscene.php">view3dscene</a> <em>File-&gt;Open</em> .</p>
</li>
<li>
<p>To run a named animation, use <em>Animations</em> panel in view3dscene.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="http://www.youtube.com/watch?v=AuI4zgmT-YQ"><img src="http://img.youtube.com/vi/AuI4zgmT-YQ/0.jpg" alt="Dragon Spine - Castle Game Engine demo"></a>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_use_spine_animations_in_your_own_games">2. How to use Spine animations in your own games</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_of_spine_and_2d_usage_in_the_engine">2.1. Overview of Spine and 2D usage in the engine</h3>
<div class="paragraph">
<p>See our <a href="https://castle-engine.io/documentation.php">engine documentation</a> for an overview how to use the engine.</p>
</div>
<div class="paragraph">
<p>When you run our <a href="https://castle-engine.io/manual_editor.php">editor</a>, create a <em>"New Project"</em> and use template <em>"2D Game"</em>. This shows a viewport with mutliple Spine scenes. A Spine scene is just a <code>TCastleScene</code> instance and you add it to <code>TCastleViewport</code> to make it visible, animated etc.</p>
</div>
<div class="paragraph">
<p>To play a Spine animation, use <code>TCastleScene.PlayAnimation</code> method. Use <code>TCastleScene.Animations</code> to list named animations. These are called "named animations" in our engine, and you can actually use them with any 3D model, not only Spine. See <a href="https://castle-engine.io/manual_scene.php">the manual about playing animations</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_spine_models">3. Creating Spine models</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Basically, just create Spine models/animations as usual, and export them to JSON. Often it is comfortable to test your animations first in <a href="https://castle-engine.io/view3dscene.php">view3dscene</a> before trying them out in your game.</p>
</div>
<div class="paragraph">
<p>You can also <a href="https://castle-engine.io/creating_data_dragon_bones.php">export from Dragon Bones</a>.</p>
</div>
<div class="paragraph">
<p>It is advised (although not required) to create an atlas when you export to JSON, as rendering with atlas will be more efficient. Atlas options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure to select "Bleed" at atlas creation options (it is necessary to avoid visible seams during rendering).</p>
</li>
<li>
<p>It is simpler to use "Atlas Per Skeleton", although we also support "Single Atlas For All Skeletons". The latter is more efficient when multiple skeletons share the images, but requires loading by a special URL like <tt>my_animation.json#atlas:my_atlas_name</tt> (see below).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spine_features_support">4. Spine features support</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_skins">4.1. Skins</h3>
<div class="ulist">
<ul>
<li>
<p>You can choose a skin at loading, by loading a filename like <tt>my_animation.json#skin:my_skin_name</tt> instead of <tt>my_animation.json</tt>.</p>
</li>
<li>
<p>By default we use the first (non-default) skin.</p>
</li>
<li>
<p>If you don&#8217;t know the list of possible skins: you can see them in Spine, or in our <a href="https://castle-engine.io/manual_log.php">log</a>.</p>
</li>
<li>
<p>For backward compatibility, instead of <tt>my_animation.json#skin:my_skin_name</tt> we also support <tt>my_animation.json#my_skin_name</tt>. But the latter form is deprecated.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_atlases">4.2. Atlases</h3>
<div class="paragraph">
<p>We fully support all Spine texture atlas options.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>This includes handling multiple atlas pages, stripping whitespace, rotating&#8230;&#8203; so you can pack your atlases really tight.</p>
</li>
<li>
<p>We also support <em>"single atlas for multiple skeletons"</em> feature of Spine. You can use it when exporting (it can be beneficial, may allow to reuse texture space better). To do this, specify atlas name explicitly, like this: <tt>my_animation.json#atlas:my_atlas_name</tt> . This will read atlas from file <tt>my_atlas_name.atlas</tt> in the same directory as <tt>my_animation.json</tt> file.
To specify both skin, and atlas name, separate them by a comma, like this: <tt>my_animation.json#skin:my_skin_name,atlas:my_atlas_name</tt> .</p>
</li>
<li>
<p>You can also work without the atlas (we expect images then to be inside <tt>images/<attachment-name>.png&lt;/tt&gt;).</attachment-name></tt></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other_features">4.3. Other features</h3>
<div class="ulist">
<ul>
<li>
<p>Support for all Spine versions, JSONs exported by Spine 3.x and 4.x are tested.</p>
</li>
<li>
<p>Of course, complete rendering of skeleton with attachments, and complete playback of normal bone animations (hierarchy of translations, rotations, scaling). All animations are imported from Spine, and can be selected by <code>TCastleSceneCore.PlayAnimation(...)</code> method.</p>
</li>
<li>
<p>Animation of slot timeline attachment, this allows to change the attachment during animation, e.g. to make something appear/disappear or for frame-by-frame animations.</p>
</li>
<li>
<p>Animation of slot color and transparency.</p>
</li>
<li>
<p>Animating slot draw order (draw order timeline).</p>
</li>
<li>
<p>Bezier curves for animating parameters.ï»¿</p>
</li>
<li>
<p>Support for "mesh" attachment.</p>
</li>
<li>
<p>Partial support for "skinnedmesh" attachment. The skinnedmesh in setup pose is affected by bones correctly, and during animation it moves as a whole (is affected by parent bone transformation). Missing is the ability to recalculate vertexes affected by bones during animation (that is, to deform skinnedmesh during animation).</p>
</li>
<li>
<p>Spine "paths" are fully supported. Internally they are converted to <code>NurbsCurve</code> X3D nodes, fully supported by the engine&#8201;&#8212;&#8201;you can render them, or query them for any purpose. They are invisible by default (<code>Shape.render</code> = false), since that is the intention of Spine paths, but you can make them visible easily if needed. From view3dscene, use <em>"Edit-&gt;Reveal All Hidden Shapes"</em> to show them.</p>
</li>
<li>
<p><a href="https://castle-engine.io/wp/2018/03/21/animation-blending/">Cross-fading between animations (Spine and otherwise) is supported since Castle Game Engine 6.5</a></p>
</li>
<li>
<p>Our implementation of Spine converts the Spine project under the hood into an X3D node graph. This means that Spine animation is a full 3D model, and uses stuff like X3D interpolators for animation. This also means that you can use all existing X3D rendering/processing tools to extend the Spine animation (for example, you can use sensors, texture settings, screen effects, you can cast shadows!, you can use shaders etc.).</p>
</li>
<li>
<p>Note that you could also create an X3D file with your 2D world, where you insert multiple Spine animations with X3D <tt>Inline</tt> node. This allows to combine multiple 2D and 3D models already at data level.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_missing_contributions_are_welcome">4.4. Missing (contributions are welcome!)</h3>
<div class="paragraph">
<p>Some more exotic Spine animation features are not implemented (yet!). If you would like to see support for them <a href="https://github.com/castle-engine/castle-engine/issues">please submit an issue</a> or ask on <a href="https://sourceforge.net/p/castle-engine/discussion/">Castle Game Engine forum</a>. Or submit a pull request :). Many of the features below are a matter of adding some reading and conversion to X3DLoadInternalSpine unit.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Attachment type "regionsequence" (should be easy, but needs test models; in principle, this should be exactly how you can use things like "xxx@counter(4).png" in X3D MovieTexture with our engine, see <a href="https://castle-engine.io/x3d_extensions.php#section_ext_movie_from_image_sequence" class="bare">https://castle-engine.io/x3d_extensions.php#section_ext_movie_from_image_sequence</a> ).</p>
</li>
<li>
<p>Attachment type "boundingbox" (easy to do, convert to X3D TransformSensor; will need special code to actually use it for something).</p>
</li>
<li>
<p>Events and Event Timeline (easy to do; note that events don&#8217;t do anything by themselves, they just allow animator to "name" some events on the timeline; we would convert them to some sensor that can be watched (using X3D ROUTE) by user code).</p>
</li>
<li>
<p>Animating vertexes of meshes using FFD. Should be easy, this is just CoordinateInterpolator in X3D.</p>
</li>
<li>
<p>Animating vertexes of skinned meshes to deform them by the bones. Should be easy, as it is already started&#8201;&#8212;&#8201;skinned meshes are correctly calculated in setup pose. It remains to calculate them for all frames of related bones, and for frames where FFD changes, and use CoordinateInterpolator.</p>
</li>
<li>
<p>IK (Inverse Kinematics). Difficulty unknown, this is a new Spine feature.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="http://www.youtube.com/watch?v=liNwT96HUqI"><img src="http://img.youtube.com/vi/liNwT96HUqI/0.jpg" alt="Spine 2D animations rendered using Castle Game Engine (view3dscene)"></a></span>
<span class="image"><a class="image" href="http://www.youtube.com/watch?v=7JZhrJ4N2Pg"><img src="http://img.youtube.com/vi/7JZhrJ4N2Pg/0.jpg" alt="New Spine features in Castle Game Engine" width="including slot timeline attachments"></a></span></p>
</div>
</div>
</div>
</div>