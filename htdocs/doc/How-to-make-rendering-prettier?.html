<div class="paragraph">
<p>This page is the opposite of the manual page <a href="https://castle-engine.io/manual_optimization.php">How to optimize your games</a> :)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use glTF, which by default does <em>PBR (Physical-Based Rendering)</em>. You can export it from <a href="https://castle-engine.io/creating_data_blender.php">Blender</a> out-of-the-box.</p>
<div class="paragraph">
<p>Some information about PBR, and how it is done in X3D in a way compatible with glTF, is available here: <a href="https://github.com/michaliskambi/x3d-tests/wiki/Include-PBR-%28PhysicalMaterial-and-related-concepts%29-in-the-official-X3D-specification" class="bare">https://github.com/michaliskambi/x3d-tests/wiki/Include-PBR-%28PhysicalMaterial-and-related-concepts%29-in-the-official-X3D-specification</a> .</p>
</div>
</li>
<li>
<p>Use bump mapping. In Blender, just set a normalmap texture (texture that affects normal vectors) and export to glTF, it just works.</p>
<div class="paragraph">
<p>Internally: use bump mapping by <code>Material.normalTexture</code> or <code>PhysicalMaterial.normalTexture</code> X3D fields. Deprecated: it is also possible by <code>CommonSurfaceShader.normalMap</code> or <code>Appearance.normalMap</code>.</p>
</div>
<div class="paragraph">
<p>Deprecated: See <a href="http://castle-engine.io/x3d_implementation_texturing_extensions.php#section_ext_common_surface_shader">ComonSurfaceShader</a> documentation. Our <a href="http://castle-engine.io/creating_data_blender.php">Blender exporter</a> can export X3D or castle-anim-frames files with the <code>CommonSurfaceShader</code> node set up.</p>
</div>
</li>
<li>
<p>Use <code>Material</code> (non-PBR) or <code>PhysicalMaterial</code> (PBR) in <a href="https://github.com/michaliskambi/x3d-tests/wiki/X3D-version-4:-New-features-of-materials,-lights-and-textures">X3D version 4</a> that adds various optional texture slots to affect various additional material parameters (e.g. specular texture in case of Phong, or metallic-roughness texture in case of PBR).</p>
</li>
<li>
<p>Set shading to Phong. You can <a href="http://castle-engine.io/x3d_implementation_shape_extensions.php#section_ext_shading">set shading per-shape</a>, but usually it&#8217;s easier to just set <code>Scene.Attributes.PhongShading := true</code> for the whole scene (TCastleScene instance).</p>
<div class="paragraph">
<p>Note that Phong shading is activated automatically (for a particular shape) when you use PBR, bump mapping or shadow maps or some other engine effect. So you may not need to actually request it explicitly.</p>
</div>
</li>
<li>
<p>Use post-processing, called "screen effects" in our engine: <a href="https://castle-engine.io/x3d_extensions_screen_effects.php" class="bare">https://castle-engine.io/x3d_extensions_screen_effects.php</a></p>
</li>
<li>
<p>Use engine effects like <a href="https://castle-engine.io/x3d_extensions_mirror_plane.php">mirrors</a> and <a href="https://castle-engine.io/x3d_extensions_shadow_maps.php">shadows</a>.</p>
</li>
<li>
<p>Use animation blending when appropriate. To do this, set <code>DefaultAnimationTransition</code> to non-zero on your scene, or use <code>PlayAnimation</code> with <code>TPlayAnimationParameters.TransitionDuration</code> set as non-zero.</p>
</li>
<li>
<p>Use <a href="https://castle-engine.io/manual_gamma_correction.php">gamma correction</a>. It is automatically used with  <code>PhysicalMaterial</code>, so it is automatically used with glTF models using PBR. You can set <code>GammaCorrection := gcAlways</code> to just use it always (also with Phong lighting or unlit materials).</p>
<div class="paragraph">
<p>This makes calculations more correct with respect to reality. This should be turned "on" from the begging of working on your graphic assets&#8201;&#8212;&#8201;as it necessarily affects to colors of everything.</p>
</div>
</li>
<li>
<p>Also try and use one of the <a href="https://castle-engine.io/apidoc-unstable/html/CastleRendererBaseTypes.html#ToneMapping">tone mapping</a> options if you feel they improve your colors.</p>
</li>
<li>
<p>You can increase the number of allowed lights per shape using <code>Scene.Attributes.MaxLightsPerShape</code>. <a href="https://castle-engine.io/view3dscene.php">view3dscene</a> has a menu item to experiment with it (<em>"View -&gt; Max Lights Per Shape&#8230;&#8203;"</em>). A test model is in <a href="https://github.com/castle-engine/demo-models/tree/master/gltf/multiple_animated_lights">demo-models: gltf/multiple_animated_lights</a>.</p>
</li>
</ul>
</div>